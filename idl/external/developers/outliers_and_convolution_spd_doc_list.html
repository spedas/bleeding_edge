<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>external/developers/outliers_and_convolution</TITLE>
</head>
 
<body>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help2</CODE>.
<br>
<P>
<STRONG>Last modified: </STRONG>Wed Aug  6 18:18:26 2025.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>Directory Listing of Routines</H1></A>
<UL>
<H1>external/developers/outliers_and_convolution</H1>
<LI><A HREF="#CONVOLVE_GAUSSIAN_1D">CONVOLVE_GAUSSIAN_1D</A>
<br>Routine convolves scalar or vector field to a given resolution
<LI><A HREF="#OUTLIERS_AND_CONVOLUTION_CRIB">OUTLIERS_AND_CONVOLUTION_CRIB</A>
<br>Crib sheet showing the use and work of the outlier removal and
<LI><A HREF="#REMOVE_OUTLIERS">REMOVE_OUTLIERS</A>
<br>Routine eliminates outliers. Quadratic trend is determined in a hollow
<LI><A HREF="#REMOVE_OUTLIERS_REPAIR">REMOVE_OUTLIERS_REPAIR</A>
<br>Routine repairs outliers. Quadratic trend is determined in a hollow
<br>
</UL><P>
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="CONVOLVE_GAUSSIAN_1D">
<H2>CONVOLVE_GAUSSIAN_1D</H2></A>
<A HREF="#OUTLIERS_AND_CONVOLUTION_CRIB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
     CONVOLVE_GAUSSIAN_1D

 PURPOSE:
 Routine convolves scalar or vector field to a given resolution
 with a Gaussian kernel

 CATEGORY:
 Data Processing

 CALLING SEQUENCE:
 convolve_gaussian_1d,resol,tarr,varrin,varrout

 INPUTS:
 resol - desired time resolution in seconds
 tarr - time array (1D, double, seconds)
 varrin - input field - 1D or mD array (ntimepoints,m)

 KEYWORDS: none

 PARAMETERS:   eps - truncate Gaussian at this height
     ni - initial length of transform is 2^ni (adjusted depending on data)
     ndump - initial length of leakage-dumping tail (adjusted by code)

 OUTPUTS:
 varrout - output array of the same dimensions that varrin

 DEPENDENCIES: None - can be used alone.

 MODIFICATION HISTORY:
 Written by: Vladimir Kondratovich 2008/10/10.
</PRE><P>
<STRONG>(See <A href="outliers_and_convolution/convolve_gaussian_1d.pro">external/developers/outliers_and_convolution/convolve_gaussian_1d.pro</A>)</STRONG><P>
<HR>
 
<A NAME="OUTLIERS_AND_CONVOLUTION_CRIB">
<H2>OUTLIERS_AND_CONVOLUTION_CRIB</H2></A>
<A HREF="#CONVOLVE_GAUSSIAN_1D">[Previous Routine]</A>
<A HREF="#REMOVE_OUTLIERS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
     OUTLIERS_AND_CONVOLUTION_CRIB

 PURPOSE:
	Crib sheet showing the use and work of the outlier removal and
	convolution routines.

 CATEGORY:
	Crib sheet

 CALLING SEQUENCE:
	crib_outliers_and_convolution

 INPUTS:
	none; the code prompts user to continue by entering .continue command

 KEYWORDS:
	none

 PARAMETERS: 3 parameters for outlier filtering and convolution are described
		and set in the code. Another parameter is set in the auxillary
		routine remove_outliers_repair.pro

 OUTPUTS:
	graphics

 DEPENDENCIES: convolve_gaussian_1d.pro, remove_outliers.pro, remove_outliers_repair.pro,
 wi_swe_load.pro, get_data.pro, xclip.pro, xdegap.pro, xdeflag.pro.

 MODIFICATION HISTORY:
	Written by:	Vladimir Kondratovich 2007/12/28.
</PRE><P>
<STRONG>(See <A href="outliers_and_convolution/outliers_and_convolution_crib.pro">external/developers/outliers_and_convolution/outliers_and_convolution_crib.pro</A>)</STRONG><P>
<HR>
 
<A NAME="REMOVE_OUTLIERS">
<H2>REMOVE_OUTLIERS</H2></A>
<A HREF="#OUTLIERS_AND_CONVOLUTION_CRIB">[Previous Routine]</A>
<A HREF="#REMOVE_OUTLIERS_REPAIR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
     REMOVE_OUTLIERS

 PURPOSE:
	Routine eliminates outliers. Quadratic trend is determined in a hollow
	vicinity of each point. The data value is compared with the trend 
	value. If the deviation is statistically improbable, the value is 
	repaired. There are 6 options for repair to be set in the subroutine
	remove_outliers_repair.pro. Routine gives the summary of its work: how 
	many of the total number of numeric values were repaired, and the number
	of failure cases (when it was impossible to establish a trend).

 CATEGORY:
	Data Processing

 CALLING SEQUENCE:
	remove_outliers, epoch, valuesin, d, tmax, nmax

 INPUTS:
	EPOCH: time array for the data values. Any time units may be used, 
		just do it consistently. Double 1D array.
  VALUESIN: 1D array of values to filter; its numerical values are 
		replaced by filtered data at the end.
	D: half-size of the hollow vicinity of the point where trend is 
		established (integer)
	TMAX: maximal time interval covered by the hollow vicinity (double)
	NMAX: maximal deviation from the trend deemed to be probable 
		(in units of standard deviation). Integer.

 KEYWORDS: None

 PARAMETERS: Repair option set in subroutine remove_outliers_repair.pro.

 OUTPUTS:
	VALUESIN: Array of filtered values (numerical values of input are replaced).
     The code may produce &quot;division by zero&quot; warnings originated in the svdfit 
     routine. They should be ignored.

 DEPENDENCIES: remove_outliers_repair.pro

 MODIFICATION HISTORY:
	Written by:	Vladimir Kondratovich 2007/12/28.
</PRE><P>
<STRONG>(See <A href="outliers_and_convolution/remove_outliers.pro">external/developers/outliers_and_convolution/remove_outliers.pro</A>)</STRONG><P>
<HR>
 
<A NAME="REMOVE_OUTLIERS_REPAIR">
<H2>REMOVE_OUTLIERS_REPAIR</H2></A>
<A HREF="#REMOVE_OUTLIERS">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
     REMOVE_OUTLIERS_REPAIR

 PURPOSE:
	Routine repairs outliers. Quadratic trend is determined in a hollow
	vicinity of each point. The data value is compared with the trend 
	value. If the deviation is statistically improbable, the value is 
	repaired. There are 6 options for repair.

 CATEGORY:
	Data Processing

 CALLING SEQUENCE:
	repair, valneib, tneib, valiin, nmax, valiout

 INPUTS:
	VALNEIB: array of the data values in the hollow vicinity of the point.
  TNEIB: array of the observation times for the above values.
  VALIIN: the value to filter.
  NMAX: maximal probable deviation from the average in units of standard 
           deviation

 KEYWORDS: None

 PARAMETERS: The code has one parameter &quot;sch&quot; setting the way outlier is 
		repaired.

 OUTPUTS:
	VALIOUT: filtered value.

 DEPENDENCIES: None. Called by remove_outliers.pro

 MODIFICATION HISTORY:
	Written by:	Vladimir Kondratovich 2007/12/28.
</PRE><P>
<STRONG>(See <A href="outliers_and_convolution/remove_outliers_repair.pro">external/developers/outliers_and_convolution/remove_outliers_repair.pro</A>)</STRONG><P>
<HR>
 
